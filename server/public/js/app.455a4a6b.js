(function(t){function e(e){for(var o,i,c=e[0],s=e[1],l=e[2],d=0,h=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&h.push(r[i][0]),r[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(t[o]=s[o]);u&&u(e);while(h.length)h.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,c=1;c<n.length;c++){var s=n[c];0!==r[s]&&(o=!1)}o&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var o={},r={app:0},a=[];function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=s;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"15a1":function(t,e,n){"use strict";n("be4f")},"1faa":function(t,e,n){},"3c22":function(t,e,n){"use strict";n("7d8d")},"560a":function(t,e,n){"use strict";n("fd6b")},"647f":function(t,e,n){"use strict";n("da5b")},6763:function(t,e,n){"use strict";n("9bb8")},"6b22":function(t,e,n){},"7d8d":function(t,e,n){},"9bb8":function(t,e,n){},be4f:function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e),n.d(e,"SlotColors",(function(){return lt}));n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),r=n("5530"),a=(n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("ac1f"),n("841c"),n("7db0"),n("159b"),n("caad"),n("2532"),n("07ac"),n("b0c0"),n("4057"),n("5502")),i=n("8e27"),c=new URLSearchParams(window.location.search),s=Object(i["io"])({extraHeaders:{admin:c.get("admin")||""},reconnectionAttempts:20});window.history.replaceState({},document.title,window.location.pathname),console.log(c.get("admin"));var l=Object(a["a"])({state:function(){return{teamSlots:[],slotPositions:[],teams:[],nextSlotId:0,nextTeamId:0,isAdmin:!1,tree:null}},mutations:{setAll:function(t,e){t.isAdmin=e.state.isAdmin,t.teams=e.state.teams,t.tree=e.state.tree,t.nextTeamId=e.state.teams.reduce((function(t,e){return Math.max(t,e.id)}),-1)+1},registerTeam:function(t,e){t.teams.push(Object(r["a"])(Object(r["a"])({},e.team),{},{id:e.id,slotId:-1})),t.nextTeamId++},registerSlot:function(t,e){var n=t.teams.find((function(t){return t.slotId===e.id}));t.teamSlots.push({id:e.id,full:!!n,color:(null===n||void 0===n?void 0:n.color)||lt.EMPTY}),t.slotPositions.push({id:e.id,x:e.pos.x,y:e.pos.y}),t.nextSlotId++},moveTeam:function(t,e){var n=t.teams.find((function(t){return t.id===e.team})),o=t.teamSlots.find((function(t){return t.id===(null===n||void 0===n?void 0:n.slotId)}));n&&(n.slotId=e.to),o&&(o.full=!1,o.color=lt.EMPTY);var r=t.teamSlots.find((function(t){return t.id===e.to}));r&&(r.full=!0,r.color=(null===n||void 0===n?void 0:n.color)||lt.EMPTY);var a={name:u.MOVE_TEAM,fromId:s.id,payload:e};e.fromServer||s.emit("mutation",a)},markSnapSlot:function(t,e){t.teamSlots.forEach((function(t){t.id!==e.id?t.color!==lt.SNAP||e.allowMultiple||(t.color=lt.EMPTY):t.color=lt.SNAP}))}},getters:{closestOpenSlot:function(t){return function(e,n){var o,r=1/0;return t.teamSlots.forEach((function(a){if(!a.full){var i=t.slotPositions.find((function(t){return t.id===a.id}));if(i){var c=h(i,{x:e,y:n});c<r&&(o=a,r=c)}}})),o}},slot:function(t){return function(e){return t.teamSlots.find((function(t){return t.id===e}))}},team:function(t){return function(e){return t.teams.find((function(t){return t.id===e}))}},slotPos:function(t){return function(e){return t.slotPositions.find((function(t){return t.id===e}))}},nextSlotId:function(t){return t.nextSlotId},nextTeamId:function(t){return t.nextTeamId}},actions:{setupSocket:function(t){var e=t.commit;s.on("mutation",(function(t){t.fromId!==s.id&&Object.values(u).includes(t.name)&&(t.payload.fromServer=!0,e(t.name,t.payload))}))}}}),u={REGISTER_SLOT:"registerSlot",REGISTER_TEAM:"registerTeam",MOVE_TEAM:"moveTeam",MARK_SNAP_SLOT:"markSnapSlot",SET_ALL:"setAll"},d={SETUP_SOCKET:"setupSocket"};function h(t,e){return Math.hypot(t.x-e.x,t.y-e.y)}function b(t,e,n,r,a,i){var c=Object(o["p"])("competition-teams"),s=Object(o["p"])("competition-tree");return Object(o["k"])(),Object(o["e"])(o["a"],null,[Object(o["g"])(c),Object(o["g"])(s)],64)}var f=n("d4ec"),m=n("bee2"),p=n("262e"),g=n("2caf"),v=(n("cb29"),n("d81d"),n("9ab4")),O={class:"tree"};function j(t,e,n,r,a,i){var c=Object(o["p"])("root-branch-display");return Object(o["k"])(),Object(o["e"])("div",O,[t.tree?(Object(o["k"])(),Object(o["c"])(c,{key:0,branch:t.tree},null,8,["branch"])):Object(o["d"])("",!0)])}var y=n("ce1f"),T=(n("99af"),n("4c53"),Object(o["f"])("h2",null,"Ã—",-1)),S=[T],E={class:"children"};function k(t,e,n,r,a,i){var c=Object(o["p"])("branch-connector"),s=Object(o["p"])("branch-display",!0);return Object(o["k"])(),Object(o["e"])("div",{class:"branch",style:Object(o["j"])("flex-direction: ".concat(t.reverse?"row-reverse":"row",";  color: ").concat(t.displayTextColor))},[Object(o["f"])("div",{class:Object(o["i"])("team-placeholder ".concat(t.beaten?"beaten":"")),style:Object(o["j"])("background-color: ".concat(t.displayColor,";"))},S,6),Object(o["g"])(c,{width:t.reverse?-32:32,height:t.cHeight},null,8,["width","height"]),Object(o["f"])("div",E,[(Object(o["k"])(!0),Object(o["e"])(o["a"],null,Object(o["o"])(t.branch.sub,(function(e,n){return Object(o["k"])(),Object(o["c"])(s,{key:n,branch:e,reverse:t.reverse,"parent-slot-id":t._slotId,"parent-beaten":t.beaten,"parent-top-color":t.passedColor},null,8,["branch","reverse","parent-slot-id","parent-beaten","parent-top-color"])})),128))])],4)}n("a9e3");var I=["width","height"],A=["d"];function M(t,e,n,r,a,i){return Object(o["k"])(),Object(o["e"])("svg",{xmlns:"http://www.w3.org/2000/svg",class:"branch-connector",width:t._width+"px",height:t._height+"px",style:Object(o["j"])(t.style)},[Object(o["f"])("path",{d:t.path},null,8,A)],12,I)}var w=function(t){Object(p["a"])(n,t);var e=Object(g["a"])(n);function n(){return Object(f["a"])(this,n),e.apply(this,arguments)}return Object(m["a"])(n,[{key:"_width",get:function(){return Math.abs(this.width||0)}},{key:"_height",get:function(){return Math.abs(this.height||0)}},{key:"style",get:function(){var t="".concat((this.width||0)<0?"1":"-1",",").concat((this.height||0)<0?"1":"-1"),e="".concat((this.height||0)<0?"margin-top":"margin-bottom",": ").concat(this._height,"px"),n=(this.width||0)<0?"right":"left";return"transform: scale(".concat(t,"); ").concat(e,"; ").concat(n,": -1rem")}},{key:"path",get:function(){var t=Math.min(this._width,this._height)/2;return"\n    M 0 0 \n    l ".concat(this._width/2-t," 0 \n    q ").concat(t," 0 ").concat(t," ").concat(t," \n    l 0 ").concat(this._height-2*t," \n    q 0 ").concat(t," ").concat(t," ").concat(t," \n    l ").concat(this._width/2-t," 0 \n    ")}}]),n}(y["b"]);w=Object(v["a"])([Object(y["a"])({name:"BranchConnector",props:{width:Number,height:Number}})],w);var x=w,_=(n("15a1"),n("d959")),C=n.n(_);const P=C()(x,[["render",M]]);var $=P,B=function(t){Object(p["a"])(n,t);var e=Object(g["a"])(n);function n(){var t;return Object(f["a"])(this,n),t=e.apply(this,arguments),t.slotId=-1,t.cHeight=0,t}return Object(m["a"])(n,[{key:"_slotId",get:function(){return this.slotId}},{key:"passedColor",get:function(){var t;return null!==(t=this.teamSlot)&&void 0!==t&&t.full?this.teamSlot.color:this.parentTopColor||lt.TEXT}},{key:"displayTextColor",get:function(){var t=this.teamSlot;return t?t.full?this.parentBeaten?lt.TEXT_BEATEN:lt.TEXT:this.parentTopColor||lt.TEXT:lt.TEXT}},{key:"displayColor",get:function(){var t=this.teamSlot;return t?t.color===lt.EMPTY?this.beaten?lt.BEATEN:lt.EMPTY:t.color:lt.LOADING}},{key:"beaten",get:function(){var t;return this.parentBeaten||(null===(t=this.teamSlot)||void 0===t?void 0:t.full)||!1}},{key:"parentSlot",get:function(){return this.$store.getters.slot(this.parentSlotId)}},{key:"teamSlot",get:function(){return this.$store.getters.slot(this.slotId)}},{key:"mounted",value:function(){this.updateCHeight();var t=this.registerSlot();t||console.log("unable to register Slot on mount",this)}},{key:"registerSlot",value:function(){var t=this.$el;if(!t)return!1;var e=t.querySelector(":scope > .team-placeholder");return!!e&&(this.slotId=this.$store.getters.nextSlotId,this.$store.commit(u.REGISTER_SLOT,{id:this.slotId,pos:{x:e.getBoundingClientRect().x,y:e.getBoundingClientRect().y}}),!0)}},{key:"updateCHeight",value:function(){var t;if(this.$el){var e=this.$el.getBoundingClientRect(),n=null===(t=this.$parent)||void 0===t?void 0:t.$el.getBoundingClientRect();this.cHeight=e.y+e.height/2-(n.y+n.height/2)}}}]),n}(y["b"]);B=Object(v["a"])([Object(y["a"])({name:"BranchDisplay",props:{branch:Object,reverse:Boolean,parentSlotId:Number,parentBeaten:Boolean,parentTopColor:String},components:{BranchDisplay:B,BranchConnector:$}})],B);var D=B;n("f3a7");const X=C()(D,[["render",k]]);var Y=X,R={class:"root-branch branch"};function U(t,e,n,r,a,i){var c=Object(o["p"])("branch-display");return Object(o["k"])(),Object(o["e"])("div",R,[t.branch.sub&&t.branch.sub.length>0?(Object(o["k"])(),Object(o["c"])(c,{key:0,branch:t.branch.sub[0],reverse:!0,"parent-slot-id":t._slotId,"parent-beaten":t.beaten,"parent-top-color":t.passedColor},null,8,["branch","parent-slot-id","parent-beaten","parent-top-color"])):Object(o["d"])("",!0),Object(o["f"])("div",{class:Object(o["i"])("team-placeholder"),style:Object(o["j"])("background-color: ".concat(t.teamSlot?t.teamSlot.color:"orange",";"))},[Object(o["f"])("h2",{class:Object(o["i"])(t.beaten?"won":"")},"ðŸ‘‘",2)],4),t.branch.sub&&t.branch.sub.length>1?(Object(o["k"])(),Object(o["c"])(c,{key:1,branch:t.branch.sub[1],reverse:!1,"parent-slot-id":t._slotId,"parent-beaten":t.beaten,"parent-top-color":t.passedColor},null,8,["branch","parent-slot-id","parent-beaten","parent-top-color"])):Object(o["d"])("",!0)])}var L=function(t){Object(p["a"])(n,t);var e=Object(g["a"])(n);function n(){return Object(f["a"])(this,n),e.apply(this,arguments)}return n}(Y);L=Object(v["a"])([Object(y["a"])({components:{BranchDisplay:Y}})],L);var N=L;n("647f");const F=C()(N,[["render",U]]);var H=F,G=function(t){Object(p["a"])(n,t);var e=Object(g["a"])(n);function n(){return Object(f["a"])(this,n),e.apply(this,arguments)}return Object(m["a"])(n,[{key:"tree",get:function(){return this.$store.state.tree}}]),n}(y["b"]);G=Object(v["a"])([Object(y["a"])({components:{BranchDisplay:Y,RootBranchDisplay:H}})],G);var K=G;n("6763");const q=C()(K,[["render",j]]);var V=q,J={key:0,class:"teams"};function W(t,e,n,r,a,i){var c=Object(o["p"])("team-display");return t.teams.length>0?(Object(o["k"])(),Object(o["e"])("div",J,[(Object(o["k"])(!0),Object(o["e"])(o["a"],null,Object(o["o"])(t.teams,(function(t,e){return Object(o["k"])(),Object(o["c"])(c,{key:e,team:t},null,8,["team"])})),128))])):Object(o["d"])("",!0)}function z(t,e,n,r,a,i){return Object(o["k"])(),Object(o["e"])("div",{class:"team",onMousedown:e[0]||(e[0]=function(){return t.startDraging&&t.startDraging.apply(t,arguments)}),onMouseup:e[1]||(e[1]=function(){return t.stopDraging&&t.stopDraging.apply(t,arguments)}),style:Object(o["j"])("transform: translate(".concat(t.x,"px, ").concat(t.y,"px); background-color: ").concat(t.team.color))},[Object(o["f"])("h2",null,Object(o["q"])(t.team.name),1)],36)}var Q=function(t){Object(p["a"])(n,t);var e=Object(g["a"])(n);function n(){var t;return Object(f["a"])(this,n),t=e.apply(this,arguments),t.dragX=0,t.dragY=0,t.dragOffsetX=0,t.dragOffsetY=0,t.teamId=-1,t.draging=!1,t}return Object(m["a"])(n,[{key:"isAdmin",get:function(){return this.$store.state.isAdmin}},{key:"x",get:function(){var t;return this.draging?this.dragX:(null===(t=this.teamSlotPos)||void 0===t?void 0:t.x)||0}},{key:"y",get:function(){var t;return this.draging?this.dragY:(null===(t=this.teamSlotPos)||void 0===t?void 0:t.y)||0}},{key:"slotId",get:function(){var t=this.$store.getters.team(this.teamId);return t?t.slotId:-1}},{key:"teamSlot",get:function(){return this.$store.getters.slot(this.slotId)}},{key:"teamSlotPos",get:function(){return this.$store.getters.slotPos(this.slotId)}},{key:"mounted",value:function(){this.teamId=this.team.id}//! ids should be defined by the socket
},{key:"registerTeam",value:function(){this.teamId=this.$store.getters.nextTeamId,this.$store.commit(u.REGISTER_TEAM,{id:this.teamId,team:this.team})}},{key:"startDraging",value:function(t){this.$el instanceof HTMLElement&&this.isAdmin&&(this.dragX=this.x,this.dragY=this.y,this.draging=!0,this.dragOffsetX=t.clientX-this.dragX,this.dragOffsetY=t.clientY-this.dragY,document.body.onpointermove=this.drag,this.$el.classList.add("selected"))}},{key:"stopDraging",value:function(t){this.$el instanceof HTMLElement&&this.isAdmin&&(this.draging=!1,document.body.onpointermove=null,this.$el.classList.remove("selected"),this.commitMoveClosest())}},{key:"commitMoveClosest",value:function(){var t=this.$store.getters.closestOpenSlot(this.dragX,this.dragY),e=t?t.id:-1;this.$store.commit(u.MOVE_TEAM,{to:e,team:this.teamId})}},{key:"drag",value:function(t){var e,n;this.dragX=t.clientX-this.dragOffsetX,this.dragY=t.clientY-this.dragOffsetY,this.dragX=Math.min(Math.max(0,this.dragX),window.innerWidth-((null===(e=this.bounds)||void 0===e?void 0:e.width)||0)),this.dragY=Math.min(Math.max(0,this.dragY),window.innerHeight-((null===(n=this.bounds)||void 0===n?void 0:n.height)||0));//! debouce this if performance too low! <(
var o=this.$store.getters.closestOpenSlot(this.dragX,this.dragY);this.$store.commit(u.MARK_SNAP_SLOT,{id:o.id})}},{key:"bounds",get:function(){return this.$el instanceof Element?this.$el.getBoundingClientRect():null}}]),n}(y["b"]);Q=Object(v["a"])([Object(y["a"])({name:"TeamDisplay",props:{team:Object}})],Q);var Z=Q;n("cf20");const tt=C()(Z,[["render",z]]);var et=tt,nt=function(t){Object(p["a"])(n,t);var e=Object(g["a"])(n);function n(){return Object(f["a"])(this,n),e.apply(this,arguments)}return Object(m["a"])(n,[{key:"teams",get:function(){return this.$store.state.teams}}]),n}(y["b"]);nt=Object(v["a"])([Object(y["a"])({components:{TeamDisplay:et}})],nt);var ot=nt;n("3c22");const rt=C()(ot,[["render",W]]);var at=rt,it=function(t){Object(p["a"])(n,t);var e=Object(g["a"])(n);function n(){return Object(f["a"])(this,n),e.apply(this,arguments)}return Object(m["a"])(n,[{key:"mounted",value:function(){this.$store.dispatch(d.SETUP_SOCKET)}},{key:"simulateData",value:function(){console.log("data arriving");var t=[{name:"yoooo team",color:"#9A879D",slotId:-1,id:-1},{name:"TEAM 2 4 U",color:"#EF233C",slotId:12,id:-1},{name:"TEAM 2 4 U",color:"#D80032",slotId:-1,id:-1},{name:"TEAM 2 4 U",color:"#A49966",slotId:-1,id:-1},{name:"TEAM 2 4 U",color:"#FF570A",slotId:-1,id:-1},{name:"yoooo team",color:"#9A879D",slotId:-1,id:-1},{name:"TEAM 2 4 U",color:"#EF233C",slotId:-1,id:-1},{name:"TEAM 2 4 U",color:"#D80032",slotId:-1,id:-1},{name:"TEAM 2 4 U",color:"#A49966",slotId:-1,id:-1},{name:"TEAM 2 4 U",color:"#FF570A",slotId:-1,id:-1},{name:"yoooo team",color:"#9A879D",slotId:-1,id:-1},{name:"TEAM 2 4 U",color:"#EF233C",slotId:-1,id:-1},{name:"TEAM 2 4 U",color:"#D80032",slotId:-1,id:-1},{name:"TEAM 2 4 U",color:"#A49966",slotId:-1,id:-1},{name:"TEAM 2 4 U",color:"#FF570A",slotId:-1,id:-1},{name:"W4F",color:"#12355B",slotId:-1,id:-1}],e={sub:Array(2).fill({sub:Array(2).fill({sub:Array(2).fill({sub:[]})})})},n={sub:[e,e]},o={isAdmin:!0,tree:n,teams:t.map((function(t,e){return Object(r["a"])(Object(r["a"])({},t),{},{id:e})}))};this.$store.commit(u.SET_ALL,{state:o})}},{key:"simulateMove",value:function(){var t={name:u.MOVE_TEAM,payload:{team:2,to:20,fromServer:!1}};t.payload.fromServer=!0,this.$store.commit(t.name,t.payload)}}]),n}(y["b"]);it=Object(v["a"])([Object(y["a"])({components:{CompetitionTree:V,CompetitionTeams:at}})],it);var ct=it;n("560a");const st=C()(ct,[["render",b]]);var lt,ut=st;(function(t){t["EMPTY"]="var(--clr-slot-empty)",t["SNAP"]="var(--clr-slot-snap)",t["BEATEN"]="var(--clr-slot-beaten)",t["TEXT_BEATEN"]="var(--clr-text-beaten)",t["TEXT"]="var(--clr-text)",t["BACKGROUND"]="var(--clr-bg)",t["LOADING"]="var(--clr-bg)"})(lt||(lt={})),Object(o["b"])(ut).use(l).mount("#app")},cf20:function(t,e,n){"use strict";n("1faa")},da5b:function(t,e,n){},f3a7:function(t,e,n){"use strict";n("6b22")},fd6b:function(t,e,n){}});
//# sourceMappingURL=app.455a4a6b.js.map